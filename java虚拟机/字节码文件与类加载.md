**Class文件结构与Dex文件结构**

```
class文件结构
1.魔术与class版本
2.常量池
3.访问标志 public、private
4.类索引、父类索引、接口索引: 确定类全限定命、父类全限定名
5.字段表：描述接口或类中声明的变量
6.方法表集合
7.属性表：
```

```
Dex文件结构
把所有的class拼成一个文件
```



类的生命周期

- 加载
  - 加载——》通过类的全路径命获取二进制流——》解析二进制放入方法区——》创建Class类的实例
- 链接
  - 验证
    - 格式（魔数）、语义（抽象类实现）、字节码（指令是否指向正确）、符号引用
  - 准备
    - 仅为静态变量分配内存
  - 解析
    - 将类、接口、字段、方法的符号引用转化为直接引用
- 初始化
  - 赋初值
  - 静态代码块执行
- 使用
- 卸载

符号引用转化为直接引用

​	符号引用是声明，直接引用是分配了内存地址





**Java类加载器**

系统类加载器：加载JDK、JRE中所提供的类

扩展类加载器：ext文件夹下jar

应用程序类加载器：加载自己工程下的内容

自定义加载器（热修复）：



**Android类加载器 自定了了类加载器**

PathClassLoader:加载已经安装的Apk的dex

DexClassLoader：加载Apk、Dex、jar、支持从SD卡中加载



loadclass 双亲委派机制

findclass 具体去找某个文件，读取字节码

defindClass 将字节码读取完后进行校验



